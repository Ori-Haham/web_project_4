!function(){"use strict";var e={874:function(e,t,r){e.exports=r.p+"3220aa0123cd7dc3fc11.jpg"},937:function(e,t,r){e.exports=r.p+"c75819857ff1599f0c50.svg"}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,r),s.exports}r.p="",function(){class e{constructor(e){let{baseUrl:t,authorizationCode:r}=e;this._baseUrl=t,this._authorization=r}returnJson(){return fetch(this._baseUrl,{headers:{authorization:this._authorization}}).then((e=>e.json()))}updateUserData(e,t){return fetch(this._baseUrl,{method:"PATCH",headers:{authorization:this._authorization,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})})}postCard(e,t){return fetch(this._baseUrl,{method:"POST",headers:{authorization:this._authorization,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})})}}var t=r(937);r(874);const n={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"};class o{constructor(e,t,r){let{handleCardClick:n}=r;var o,s;s=()=>{this._element.remove(),this._element=null},(o="_hendelDelete")in this?Object.defineProperty(this,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[o]=s,this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleCardClick=n}t(){return{name:this._name}}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._handleCardClickListener(),this._handleDeleteButton(),this._handleCardLikeButton()}_handleCardClickListener(){this._element.querySelector(".card__image").addEventListener("click",(e=>{this._handleCardClick(e)}))}_handleDeleteButton(){this._element.querySelector(".card__remove-button").addEventListener("click",this._hendelDelete)}_handleCardLikeButton(){this._element.querySelector(".card__like-button").addEventListener("click",(function(e){e.target.classList.toggle("card__like-button_active")}))}generateCard(){this._element=this._getTemplate(),this._setEventListeners();const e=this._element.querySelector(".card__image");return e.src=this._link,e.alt=this._name,this._element.querySelector(".card__location").textContent=this._name,this._element}}class s{constructor(e,t){var r,n;n=()=>{this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState(this._inputList,this._buttonElement)},(r="resetValidation")in this?Object.defineProperty(this,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[r]=n,this._formSelector=e,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass}_showInputError(e,t){this._errorElement=this._formElement.querySelector(".".concat(e.id,"-error")),e.classList.add(this._inputErrorClass),this._errorElement.textContent=t,this._errorElement.classList.add(this._errorClass)}_hideInputError(e){this._errorElement=this._formElement.querySelector(".".concat(e.id,"-error")),e.classList.remove(this._inputErrorClass),this._errorElement.classList.remove(this._errorClass),this._errorElement.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this._inputList=[...this._formElement.querySelectorAll(this._inputSelector)],this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._inputList,this._buttonElement)}))}))}enableValidation(){this._formElement=document.querySelector(this._formSelector),this._setEventListeners()}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class a{constructor(e){i(this,"_handleEscClose",(e=>{"Escape"===e.key&&this._popup.classList.add("popup-hidden")})),i(this,"_handleMouseDown",(e=>{const t=this._popup.querySelector(".popup__close-button");(e.target===t||e.target.classList.contains("popup"))&&this.close()})),this._popup=e}open(){this._popup.classList.remove("popup-hidden"),this.setEventListeners()}close(){this._popup.classList.add("popup-hidden"),this.removeEventListeners()}setEventListeners(){window.addEventListener("keydown",this._handleEscClose),this._popup.addEventListener("mousedown",this._handleMouseDown)}removeEventListeners(){window.removeEventListener("keydown",this._handleEscClose),this._popup.removeEventListener("mousedown",this._handleMouseDown)}}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class u extends a{constructor(e,t,r){let{handleFormSubmit:n}=r;super(e),l(this,"close",(()=>{super.close(),this._form.reset(),this.removeEventListeners()})),l(this,"setEventListeners",(()=>{super.setEventListeners(),this._form.addEventListener("submit",this._handleSubmit)})),l(this,"removeEventListeners",(()=>{super.removeEventListeners(),this._form.removeEventListener("submit",this._handleSubmit)})),l(this,"_handleSubmit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),this._form=document.querySelector(t),this._handleFormSubmit=n}_getInputValues(){const e=[...this._popup.querySelectorAll(".popup__input")],t={};return e.forEach((e=>{t[e.name]=e.value})),t}}const c=document.querySelector(".profile__edit-button"),h=document.querySelector(".profile__add-button"),d=document.querySelector(".profile__name"),p=document.querySelector(".profile__about-me"),_=(document.querySelector(".profile__image"),document.querySelector(".profile-popup")),m=(_.querySelector(".profile-popup__close-button"),document.querySelector(".card-popup")),b=(m.querySelector(".card-popup__close-button"),document.querySelector(".profile-form")),f=b.querySelector(".profile-form__name"),v=b.querySelector(".profile-form__about-me"),E=(b.querySelector(".profile-form__submit-button"),document.querySelector(".card-form")),S=E.querySelector(".card-form__place"),y=E.querySelector(".card-form__url"),g=document.querySelector(".cards"),C=document.querySelector(".image-popup"),L=(C.querySelector(".image-popup__close-button"),C.querySelector(".image-popup__image")),q=C.querySelector(".image-popup__location"),w={name:d.textContent,about:p.textContent},I=new e({baseUrl:"https://around.nomoreparties.co/v1/group-12/cards",authorizationCode:"37c0271e-6c35-4cdb-bfdd-3d6b737f9411"}),k=new e({baseUrl:"https://around.nomoreparties.co/v1/group-12/users/me",authorizationCode:"37c0271e-6c35-4cdb-bfdd-3d6b737f9411"}),U=new e({baseUrl:"https://around.nomoreparties.co/v1/group-12/users/me",authorizationCode:"37c0271e-6c35-4cdb-bfdd-3d6b737f9411"}),B=new e({baseUrl:"https://around.nomoreparties.co/v1/group-12/cards",authorizationCode:"37c0271e-6c35-4cdb-bfdd-3d6b737f9411"});function x(){k.returnJson().then((e=>{var t,r;t=e.name,r=e.about,d.textContent=t,p.textContent=r}))}const z=new class{constructor(e){let{data:t}=e;this._nameElement=t.name,this._aboutMeElement=t.about}getUserInfo(){const e={};return e.name=this._nameElement,e.about=this._aboutMeElement,e}setUserInfo(e,t){this._nameElement=e,this._aboutMeElement=t}}({data:w});k.returnJson().then((e=>{z.setUserInfo(e.name,e.about)}));const j=new class extends a{constructor(e,t,r){var n,o;super(e),o=e=>{let{src:t,alt:r}=e;super.open(),this._popupImage.src=t,this._popupImage.alt=r,this._popupLocation.textContent=r},(n="open")in this?Object.defineProperty(this,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):this.open=o,this._popupImage=t,this._popupLocation=r}}(C,L,q),D=new s(".profile-form",n),V=new s(".card-form",n),O=new u(_,".profile-form",{handleFormSubmit:()=>{z.setUserInfo(f.value,v.value),U.updateUserData(z.getUserInfo().name,z.getUserInfo().about).then((()=>{x()})),O.close()}}),P=new class{constructor(e,t){let{data:r,renderer:n}=e;this._data=r,this._container=t,this._renderer=n}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:function(e){console.log(e);const t=new o(e,"#card-template",{handleCardClick:e=>{j.open({src:e.target.src,alt:e.target.alt})}}).generateCard();P.addItem(t)}},g);I.returnJson().then((e=>{P.renderItems(e)}));const M=new u(m,".card-form",{handleFormSubmit:()=>{B.postCard(S.value,y.value).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).then((e=>{console.log(e)})).then((e=>{P.renderItems([e])})).then((()=>{M.close()}))}});x(),c.addEventListener("click",(function(){!function(){const e=z.getUserInfo();f.value=e.name,v.value=e.about}(),D.resetValidation(),O.open()})),h.addEventListener("click",(function(){V.resetValidation(),M.open()})),D.enableValidation(),V.enableValidation(),document.getElementById("logo").src=t}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxLQUFLLENBQUV4QyxJQUFLUCxFQUFJRSxPQUFPSyxJQUFLQyxJQUFLUixFQUFJRSxPQUFPTSxTQUdsQ0gsZUFDekJnRyxFQUFTUSxRQUFRSyxLQU9qQm5DLEdBR0ZLLEVBQWdCaEksYUFBYUksTUFBTUMsSUFDakM0SSxFQUFTTSxZQUFZbEosTUFHdkIsTUFBTTBKLEVBQWlCLElBQUk3RCxFQUFja0IsRUFBVyxhQUFjLENBQ2hFaEIsaUJBQWtCLEtBQ2hCK0IsRUFDR3JILFNBQVMyRyxFQUFXWCxNQUFPWSxFQUFTWixPQUNwQzFHLE1BQU00SixHQUNEQSxFQUFLQyxHQUNBRCxFQUFLMUosT0FFUDRKLFFBQVFDLE9BQVIsaUJBQXlCSCxFQUFLSSxXQUV0Q2hLLE1BQU00SixJQUNMSixRQUFRQyxJQUFJRyxNQUViNUosTUFBTTRKLElBQ0xmLEVBQVNNLFlBQVksQ0FBQ1MsT0FFdkI1SixNQUFLLEtBQ0oySixFQUFlckUsY0FzQnZCMEMsSUFFQXJCLEVBQXVCcEUsaUJBQWlCLFNBYnhDLFlBTkEsV0FDRSxNQUFNMEgsRUFBV2hDLEVBQVNHLGNBQzFCbEIsRUFBVVIsTUFBUXVELEVBQVM3SixLQUMzQitHLEVBQVdULE1BQVF1RCxFQUFTNUosTUFJNUI2SixHQUNBeEIsRUFBcUJ5QixrQkFDckJ2QixFQUFrQnJELFVBWXBCcUIsRUFBb0JyRSxpQkFBaUIsU0FUckMsV0FDRW9HLEVBQWtCd0Isa0JBQ2xCUixFQUFlcEUsVUFTakJtRCxFQUFxQjNELG1CQUVyQjRELEVBQWtCNUQsbUJBRUFoRCxTQUFTcUksZUFBZSxRQUNoQ3JILElBQU1zSCxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80L3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvdXRpbHMvZm9ybVZhbGlkYXRpb25PYmplY3QuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0gLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9TZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBhdXRob3JpemF0aW9uQ29kZSB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2F1dGhvcml6YXRpb24gPSBhdXRob3JpemF0aW9uQ29kZTtcclxuICB9XHJcblxyXG4gIHJldHVybkpzb24oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCwge1xyXG4gICAgICBoZWFkZXJzOiB7IGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24gfSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlVXNlckRhdGEobmFtZSwgYWJvdXQpIHtcclxuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IGFib3V0LFxyXG4gICAgICB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcG9zdENhcmQobmFtZSwgbGluaykge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIGxpbms6IGxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjb25zdCBmb3JtVmFsaWRhdGlvbk9iamVjdCA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dC1lcnJvcl9hY3RpdmVcIixcclxufTtcclxuIiwiY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoZGF0YSwgY2FyZFNlbGVjdG9yLCB7IGhhbmRsZUNhcmRDbGljayB9KSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcclxuICB9XHJcblxyXG4gIHQoKSB7XHJcbiAgICBjb25zdCB0ID0geyBuYW1lOiB0aGlzLl9uYW1lIH07XHJcbiAgICByZXR1cm4gdDtcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfaGVuZGVsRGVsZXRlID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xyXG4gIH07XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGlja0xpc3RlbmVyKCk7XHJcblxyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uKCk7XHJcblxyXG4gICAgdGhpcy5faGFuZGxlQ2FyZExpa2VCdXR0b24oKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVDYXJkQ2xpY2tMaXN0ZW5lcigpIHtcclxuICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIGNhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2soZXZ0KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZURlbGV0ZUJ1dHRvbigpIHtcclxuICAgIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19yZW1vdmUtYnV0dG9uXCIpO1xyXG4gICAgZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oZW5kZWxEZWxldGUpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUNhcmRMaWtlQnV0dG9uKCkge1xyXG4gICAgY29uc3QgY2FyZExpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgICBjYXJkTGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICBjb25zdCBpbWFnZUVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcblxyXG4gICAgaW1hZ2VFbGVtZW50LnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICBpbWFnZUVsZW1lbnQuYWx0ID0gdGhpcy5fbmFtZTtcclxuXHJcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbG9jYXRpb25cIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IHsgQ2FyZCB9O1xyXG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3Rvcihmb3JtU2VsZWN0b3IsIHZhbGlkYXRpb25PYmplY3QpIHtcclxuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IGZvcm1TZWxlY3RvcjtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSB2YWxpZGF0aW9uT2JqZWN0LmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHZhbGlkYXRpb25PYmplY3Quc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gdmFsaWRhdGlvbk9iamVjdC5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gdmFsaWRhdGlvbk9iamVjdC5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gdmFsaWRhdGlvbk9iamVjdC5lcnJvckNsYXNzO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XHJcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xyXG4gICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRMaXN0KSkge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbXHJcbiAgICAgIC4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvciksXHJcbiAgICBdO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUodGhpcy5faW5wdXRMaXN0LCB0aGlzLl9idXR0b25FbGVtZW50KTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fZm9ybVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24gPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dExpc3QsIHRoaXMuX2J1dHRvbkVsZW1lbnQpO1xyXG4gIH07XHJcbn1cclxuXHJcbmV4cG9ydCB7IEZvcm1WYWxpZGF0b3IgfTtcclxuIiwiZXhwb3J0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9wb3B1cCA9IHBvcHVwU2VsZWN0b3I7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwLWhpZGRlblwiKTtcclxuICAgIHRoaXMuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwLWhpZGRlblwiKTtcclxuICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlTW91c2VEb3duKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIHRoaXMuX3BvcHVwLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlTW91c2VEb3duKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cC1oaWRkZW5cIik7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX2hhbmRsZU1vdXNlRG93biA9IChldnQpID0+IHtcclxuICAgIGNvbnN0IGNsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2UtYnV0dG9uXCIpO1xyXG4gICAgaWYgKGV2dC50YXJnZXQgPT09IGNsb3NlQnV0dG9uIHx8IGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBcIikpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBmb3JtLCB7IGhhbmRsZUZvcm1TdWJtaXQgfSkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9mb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihmb3JtKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRMaXN0ID0gWy4uLnRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2lucHV0XCIpXTtcclxuXHJcbiAgICBjb25zdCBmb3JtVmFsdWVzID0ge307XHJcblxyXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGZvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGZvcm1WYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBjbG9zZSA9ICgpID0+IHtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVN1Ym1pdCk7XHJcbiAgfTtcclxuXHJcbiAgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICBzdXBlci5yZW1vdmVFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVN1Ym1pdCk7XHJcbiAgfTtcclxuXHJcbiAgX2hhbmRsZVN1Ym1pdCA9IChldnQpID0+IHtcclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICB9O1xyXG59XHJcbiIsImNvbnN0IHByb2ZpbGVQb3B1cE9wZW5CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBjYXJkUG9wdXBPcGVuQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5cclxuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XHJcbmNvbnN0IHByb2ZpbGVBYm91dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWJvdXQtbWVcIik7XHJcbmNvbnN0IHByb2ZpbGVJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XHJcblxyXG5jb25zdCBwcm9maWxlUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGUtcG9wdXBcIik7XHJcbmNvbnN0IHByb2ZpbGVQb3B1cENsb3NlQnV0dG9uID0gcHJvZmlsZVBvcHVwLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZS1wb3B1cF9fY2xvc2UtYnV0dG9uXCJcclxuKTtcclxuXHJcbmNvbnN0IGNhcmRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZC1wb3B1cFwiKTtcclxuY29uc3QgY2FyZFBvcHVwQ2xvc2VCdXR0b24gPSBjYXJkUG9wdXAucXVlcnlTZWxlY3RvcihcclxuICBcIi5jYXJkLXBvcHVwX19jbG9zZS1idXR0b25cIlxyXG4pO1xyXG5cclxuY29uc3QgcHJvZmlsZUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGUtZm9ybVwiKTtcclxuY29uc3QgbmFtZUlucHV0ID0gcHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlLWZvcm1fX25hbWVcIik7XHJcbmNvbnN0IGFib3V0SW5wdXQgPSBwcm9maWxlRm9ybS5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGUtZm9ybV9fYWJvdXQtbWVcIik7XHJcbmNvbnN0IHN1Ym1pdFByb2ZpbGVCdXR0b24gPSBwcm9maWxlRm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnByb2ZpbGUtZm9ybV9fc3VibWl0LWJ1dHRvblwiXHJcbik7XHJcblxyXG5jb25zdCBjYXJkRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZC1mb3JtXCIpO1xyXG5jb25zdCBwYWxjZUlucHV0ID0gY2FyZEZvcm0ucXVlcnlTZWxlY3RvcihcIi5jYXJkLWZvcm1fX3BsYWNlXCIpO1xyXG5jb25zdCB1cmxJbnB1dCA9IGNhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZC1mb3JtX191cmxcIik7XHJcblxyXG5jb25zdCBjYXJkc0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNcIik7XHJcblxyXG5jb25zdCBpbWFnZVBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbWFnZS1wb3B1cFwiKTtcclxuY29uc3QgaW1hZ2VQb3B1cENsb3NlQnV0dG9uID0gaW1hZ2VQb3B1cC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLmltYWdlLXBvcHVwX19jbG9zZS1idXR0b25cIlxyXG4pO1xyXG5jb25zdCBpbWFnZVBvcHVwSW1hZ2UgPSBpbWFnZVBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuaW1hZ2UtcG9wdXBfX2ltYWdlXCIpO1xyXG5jb25zdCBpbWFnZVBvcHVwTG9jYXRpb24gPSBpbWFnZVBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuaW1hZ2UtcG9wdXBfX2xvY2F0aW9uXCIpO1xyXG5cclxuY29uc3QgdXNlckluZm9PYmplY3QgPSB7XHJcbiAgbmFtZTogcHJvZmlsZU5hbWUudGV4dENvbnRlbnQsXHJcbiAgYWJvdXQ6IHByb2ZpbGVBYm91dC50ZXh0Q29udGVudCxcclxufTtcclxuXHJcbmV4cG9ydCB7XHJcbiAgcHJvZmlsZVBvcHVwT3BlbkJ1dHRvbixcclxuICBjYXJkUG9wdXBPcGVuQnV0dG9uLFxyXG4gIHByb2ZpbGVOYW1lLFxyXG4gIHByb2ZpbGVBYm91dCxcclxuICBwcm9maWxlSW1hZ2UsXHJcbiAgcHJvZmlsZVBvcHVwLFxyXG4gIHByb2ZpbGVQb3B1cENsb3NlQnV0dG9uLFxyXG4gIGNhcmRQb3B1cCxcclxuICBjYXJkUG9wdXBDbG9zZUJ1dHRvbixcclxuICBwcm9maWxlRm9ybSxcclxuICBuYW1lSW5wdXQsXHJcbiAgYWJvdXRJbnB1dCxcclxuICBzdWJtaXRQcm9maWxlQnV0dG9uLFxyXG4gIGNhcmRGb3JtLFxyXG4gIHBhbGNlSW5wdXQsXHJcbiAgdXJsSW5wdXQsXHJcbiAgY2FyZHNDb250YWluZXIsXHJcbiAgaW1hZ2VQb3B1cCxcclxuICBpbWFnZVBvcHVwQ2xvc2VCdXR0b24sXHJcbiAgaW1hZ2VQb3B1cEltYWdlLFxyXG4gIGltYWdlUG9wdXBMb2NhdGlvbixcclxuICB1c2VySW5mb09iamVjdCxcclxufTtcclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5cclxuaW1wb3J0IGxvZ29TcmMgZnJvbSBcIi4uL2ltYWdlcy9sb2dvLnN2Z1wiO1xyXG5pbXBvcnQgcHJvZmlsZVNyYyBmcm9tIFwiLi4vaW1hZ2VzL2Zyb2ZpbGUtaW1hZ2UuanBnXCI7XHJcbmltcG9ydCB7IGZvcm1WYWxpZGF0aW9uT2JqZWN0IH0gZnJvbSBcIi4uL3NjcmlwdHMvdXRpbHMvZm9ybVZhbGlkYXRpb25PYmplY3QuanNcIjtcclxuaW1wb3J0IHsgQ2FyZCB9IGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yIH0gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0gXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvXCI7XHJcbmltcG9ydCB7XHJcbiAgcHJvZmlsZVBvcHVwT3BlbkJ1dHRvbixcclxuICBjYXJkUG9wdXBPcGVuQnV0dG9uLFxyXG4gIHByb2ZpbGVQb3B1cCxcclxuICBjYXJkUG9wdXAsXHJcbiAgbmFtZUlucHV0LFxyXG4gIGFib3V0SW5wdXQsXHJcbiAgY2FyZHNDb250YWluZXIsXHJcbiAgaW1hZ2VQb3B1cCxcclxuICB1c2VySW5mb09iamVjdCxcclxuICBpbWFnZVBvcHVwSW1hZ2UsXHJcbiAgaW1hZ2VQb3B1cExvY2F0aW9uLFxyXG4gIHBhbGNlSW5wdXQsXHJcbiAgdXJsSW5wdXQsXHJcbiAgcHJvZmlsZU5hbWUsXHJcbiAgcHJvZmlsZUFib3V0LFxyXG59IGZyb20gXCIuLi9zY3JpcHRzL3V0aWxzL2NvbnN0YW50c1wiO1xyXG5cclxuY29uc3QgaW5pdGlhbENhcmRkQXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL2NhcmRzXCIsXHJcbiAgYXV0aG9yaXphdGlvbkNvZGU6IFwiMzdjMDI3MWUtNmMzNS00Y2RiLWJmZGQtM2Q2YjczN2Y5NDExXCIsXHJcbn0pO1xyXG5cclxuY29uc3QgZ2V0VXNlckluZm9BcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvdXNlcnMvbWVcIixcclxuICBhdXRob3JpemF0aW9uQ29kZTogXCIzN2MwMjcxZS02YzM1LTRjZGItYmZkZC0zZDZiNzM3Zjk0MTFcIixcclxufSk7XHJcblxyXG5jb25zdCB1cGRhdGVVc2VySW5mb0FwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMi91c2Vycy9tZVwiLFxyXG4gIGF1dGhvcml6YXRpb25Db2RlOiBcIjM3YzAyNzFlLTZjMzUtNGNkYi1iZmRkLTNkNmI3MzdmOTQxMVwiLFxyXG59KTtcclxuXHJcbmNvbnN0IHBvc3RDYXJkQXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL2NhcmRzXCIsXHJcbiAgYXV0aG9yaXphdGlvbkNvZGU6IFwiMzdjMDI3MWUtNmMzNS00Y2RiLWJmZGQtM2Q2YjczN2Y5NDExXCIsXHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gc2V0UHJvZmlsZUluZm8obmFtZSwgYWJvdXQpIHtcclxuICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgcHJvZmlsZUFib3V0LnRleHRDb250ZW50ID0gYWJvdXQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRlbFVzZXJJbmZvKCkge1xyXG4gIGdldFVzZXJJbmZvQXBpLnJldHVybkpzb24oKS50aGVuKChyZXMpID0+IHtcclxuICAgIHNldFByb2ZpbGVJbmZvKHJlcy5uYW1lLCByZXMuYWJvdXQpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7IGRhdGE6IHVzZXJJbmZvT2JqZWN0IH0pO1xyXG5cclxuZ2V0VXNlckluZm9BcGkucmV0dXJuSnNvbigpLnRoZW4oKHJlcykgPT4ge1xyXG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHJlcy5uYW1lLCByZXMuYWJvdXQpO1xyXG59KTtcclxuXHJcbmNvbnN0IHBvcHVwSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXHJcbiAgaW1hZ2VQb3B1cCxcclxuICBpbWFnZVBvcHVwSW1hZ2UsXHJcbiAgaW1hZ2VQb3B1cExvY2F0aW9uXHJcbik7XHJcblxyXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIFwiLnByb2ZpbGUtZm9ybVwiLFxyXG4gIGZvcm1WYWxpZGF0aW9uT2JqZWN0XHJcbik7XHJcblxyXG5jb25zdCBjYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFwiLmNhcmQtZm9ybVwiLCBmb3JtVmFsaWRhdGlvbk9iamVjdCk7XHJcblxyXG5jb25zdCBwcm9maWxlUG9wdXBDbGFzcyA9IG5ldyBQb3B1cFdpdGhGb3JtKHByb2ZpbGVQb3B1cCwgXCIucHJvZmlsZS1mb3JtXCIsIHtcclxuICBoYW5kbGVGb3JtU3VibWl0OiAoKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyhuYW1lSW5wdXQudmFsdWUsIGFib3V0SW5wdXQudmFsdWUpO1xyXG4gICAgdXBkYXRlVXNlckluZm9BcGlcclxuICAgICAgLnVwZGF0ZVVzZXJEYXRhKHVzZXJJbmZvLmdldFVzZXJJbmZvKCkubmFtZSwgdXNlckluZm8uZ2V0VXNlckluZm8oKS5hYm91dClcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGhhbmRlbFVzZXJJbmZvKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgcHJvZmlsZVBvcHVwQ2xhc3MuY2xvc2UoKTtcclxuICB9LFxyXG59KTtcclxuXHJcbmZ1bmN0aW9uIHJlbmRlckNhcmQoaXRlbSkge1xyXG4gIGNvbnNvbGUubG9nKGl0ZW0pO1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChpdGVtLCBcIiNjYXJkLXRlbXBsYXRlXCIsIHtcclxuICAgIGhhbmRsZUNhcmRDbGljazogKGV2dCkgPT4ge1xyXG4gICAgICBwb3B1cEltYWdlLm9wZW4oeyBzcmM6IGV2dC50YXJnZXQuc3JjLCBhbHQ6IGV2dC50YXJnZXQuYWx0IH0pO1xyXG4gICAgfSxcclxuICB9KTtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbiAgY2FyZExpc3QuYWRkSXRlbShjYXJkRWxlbWVudCk7XHJcbn1cclxuXHJcbmNvbnN0IGNhcmRMaXN0ID0gbmV3IFNlY3Rpb24oXHJcbiAge1xyXG4gICAgcmVuZGVyZXI6IHJlbmRlckNhcmQsXHJcbiAgfSxcclxuICBjYXJkc0NvbnRhaW5lclxyXG4pO1xyXG5cclxuaW5pdGlhbENhcmRkQXBpLnJldHVybkpzb24oKS50aGVuKChyZXMpID0+IHtcclxuICBjYXJkTGlzdC5yZW5kZXJJdGVtcyhyZXMpO1xyXG59KTtcclxuXHJcbmNvbnN0IGNhcmRQb3B1cENsYXNzID0gbmV3IFBvcHVwV2l0aEZvcm0oY2FyZFBvcHVwLCBcIi5jYXJkLWZvcm1cIiwge1xyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6ICgpID0+IHtcclxuICAgIHBvc3RDYXJkQXBpXHJcbiAgICAgIC5wb3N0Q2FyZChwYWxjZUlucHV0LnZhbHVlLCB1cmxJbnB1dC52YWx1ZSlcclxuICAgICAgLnRoZW4oKGNhcmQpID0+IHtcclxuICAgICAgICBpZiAoY2FyZC5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIGNhcmQuanNvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke2NhcmQuc3RhdHVzfWApO1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigoY2FyZCkgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGNhcmQpO1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigoY2FyZCkgPT4ge1xyXG4gICAgICAgIGNhcmRMaXN0LnJlbmRlckl0ZW1zKFtjYXJkXSk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBjYXJkUG9wdXBDbGFzcy5jbG9zZSgpO1xyXG4gICAgICB9KTtcclxuICB9LFxyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGZpbGxQcm9maWxlRm9ybSgpIHtcclxuICBjb25zdCB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgbmFtZUlucHV0LnZhbHVlID0gdXNlckRhdGEubmFtZTtcclxuICBhYm91dElucHV0LnZhbHVlID0gdXNlckRhdGEuYWJvdXQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5Qcm9maWxlRm9ybSgpIHtcclxuICBmaWxsUHJvZmlsZUZvcm0oKTtcclxuICBwcm9maWxlRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICBwcm9maWxlUG9wdXBDbGFzcy5vcGVuKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5DYXJkUG9wdXAoKSB7XHJcbiAgY2FyZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgY2FyZFBvcHVwQ2xhc3Mub3BlbigpO1xyXG59XHJcblxyXG5oYW5kZWxVc2VySW5mbygpO1xyXG5cclxucHJvZmlsZVBvcHVwT3BlbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb3BlblByb2ZpbGVGb3JtKTtcclxuXHJcbmNhcmRQb3B1cE9wZW5CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5DYXJkUG9wdXApO1xyXG5cclxucHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgbG9nb0ltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsb2dvXCIpO1xyXG5sb2dvSW1hZ2Uuc3JjID0gbG9nb1NyYztcclxuXHJcbi8qY29uc3QgaW5wdXRMaXN0ID0gWy4uLmNhcmRQb3B1cC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKV07XHJcblxyXG4gICAgICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcblxyXG4gICAgICAgIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgICAgICB9KTsqL1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyBkYXRhIH0pIHtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fYWJvdXRNZUVsZW1lbnQgPSBkYXRhLmFib3V0O1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICBjb25zdCB1c2VySW5mbyA9IHt9O1xyXG5cclxuICAgIHVzZXJJbmZvLm5hbWUgPSB0aGlzLl9uYW1lRWxlbWVudDtcclxuICAgIHVzZXJJbmZvLmFib3V0ID0gdGhpcy5fYWJvdXRNZUVsZW1lbnQ7XHJcblxyXG4gICAgcmV0dXJuIHVzZXJJbmZvO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8obmFtZSwgYWJvdXQpIHtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2Fib3V0TWVFbGVtZW50ID0gYWJvdXQ7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIHBvcHVwSW1hZ2UsIHBvcHVwTG9jYXRpb24pIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IHBvcHVwSW1hZ2U7XHJcbiAgICB0aGlzLl9wb3B1cExvY2F0aW9uID0gcG9wdXBMb2NhdGlvbjtcclxuICB9XHJcbiAgb3BlbiA9ICh7IHNyYywgYWx0IH0pID0+IHtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2Uuc3JjID0gc3JjO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5hbHQgPSBhbHQ7XHJcbiAgICB0aGlzLl9wb3B1cExvY2F0aW9uLnRleHRDb250ZW50ID0gYWx0O1xyXG4gIH07XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBkYXRhLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBjb250YWluZXJTZWxlY3RvcjtcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcyhkYXRhKSB7XHJcbiAgICBkYXRhLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsInAiLCJBcGkiLCJjb25zdHJ1Y3RvciIsImJhc2VVcmwiLCJhdXRob3JpemF0aW9uQ29kZSIsInRoaXMiLCJfYmFzZVVybCIsIl9hdXRob3JpemF0aW9uIiwicmV0dXJuSnNvbiIsImZldGNoIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJ0aGVuIiwicmVzIiwianNvbiIsInVwZGF0ZVVzZXJEYXRhIiwibmFtZSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJwb3N0Q2FyZCIsImxpbmsiLCJmb3JtVmFsaWRhdGlvbk9iamVjdCIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiQ2FyZCIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJfZWxlbWVudCIsInJlbW92ZSIsIl9uYW1lIiwiX2xpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsInQiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2hhbmRsZUNhcmRDbGlja0xpc3RlbmVyIiwiX2hhbmRsZURlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVDYXJkTGlrZUJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJldnQiLCJfaGVuZGVsRGVsZXRlIiwidGFyZ2V0IiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiZ2VuZXJhdGVDYXJkIiwiaW1hZ2VFbGVtZW50Iiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJGb3JtVmFsaWRhdG9yIiwidmFsaWRhdGlvbk9iamVjdCIsIl9pbnB1dExpc3QiLCJmb3JFYWNoIiwiaW5wdXRFbGVtZW50IiwiX2hpZGVJbnB1dEVycm9yIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2J1dHRvbkVsZW1lbnQiLCJfZm9ybVNlbGVjdG9yIiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsIl9zaG93SW5wdXRFcnJvciIsImVycm9yTWVzc2FnZSIsIl9lcnJvckVsZW1lbnQiLCJfZm9ybUVsZW1lbnQiLCJpZCIsImFkZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGFzSW52YWxpZElucHV0IiwiaW5wdXRMaXN0Iiwic29tZSIsImRpc2FibGVkIiwicXVlcnlTZWxlY3RvckFsbCIsImVuYWJsZVZhbGlkYXRpb24iLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJrZXkiLCJfcG9wdXAiLCJjbG9zZUJ1dHRvbiIsImNvbnRhaW5zIiwiY2xvc2UiLCJvcGVuIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJyZW1vdmVFdmVudExpc3RlbmVycyIsIndpbmRvdyIsIl9oYW5kbGVFc2NDbG9zZSIsIl9oYW5kbGVNb3VzZURvd24iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiUG9wdXBXaXRoRm9ybSIsImZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfZm9ybSIsInJlc2V0IiwiX2hhbmRsZVN1Ym1pdCIsInByZXZlbnREZWZhdWx0IiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJmb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInByb2ZpbGVQb3B1cE9wZW5CdXR0b24iLCJjYXJkUG9wdXBPcGVuQnV0dG9uIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlQWJvdXQiLCJwcm9maWxlUG9wdXAiLCJjYXJkUG9wdXAiLCJwcm9maWxlRm9ybSIsIm5hbWVJbnB1dCIsImFib3V0SW5wdXQiLCJjYXJkRm9ybSIsInBhbGNlSW5wdXQiLCJ1cmxJbnB1dCIsImNhcmRzQ29udGFpbmVyIiwiaW1hZ2VQb3B1cCIsImltYWdlUG9wdXBJbWFnZSIsImltYWdlUG9wdXBMb2NhdGlvbiIsInVzZXJJbmZvT2JqZWN0IiwiaW5pdGlhbENhcmRkQXBpIiwiZ2V0VXNlckluZm9BcGkiLCJ1cGRhdGVVc2VySW5mb0FwaSIsInBvc3RDYXJkQXBpIiwiaGFuZGVsVXNlckluZm8iLCJ1c2VySW5mbyIsIl9uYW1lRWxlbWVudCIsIl9hYm91dE1lRWxlbWVudCIsImdldFVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJwb3B1cEltYWdlIiwicG9wdXBMb2NhdGlvbiIsIl9wb3B1cEltYWdlIiwiX3BvcHVwTG9jYXRpb24iLCJwcm9maWxlRm9ybVZhbGlkYXRvciIsImNhcmRGb3JtVmFsaWRhdG9yIiwicHJvZmlsZVBvcHVwQ2xhc3MiLCJjYXJkTGlzdCIsImNvbnRhaW5lclNlbGVjdG9yIiwicmVuZGVyZXIiLCJfZGF0YSIsIl9jb250YWluZXIiLCJfcmVuZGVyZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJjb25zb2xlIiwibG9nIiwiY2FyZEVsZW1lbnQiLCJjYXJkUG9wdXBDbGFzcyIsImNhcmQiLCJvayIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJ1c2VyRGF0YSIsImZpbGxQcm9maWxlRm9ybSIsInJlc2V0VmFsaWRhdGlvbiIsImdldEVsZW1lbnRCeUlkIiwibG9nb1NyYyJdLCJzb3VyY2VSb290IjoiIn0=